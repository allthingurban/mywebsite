---
title: "ACCESS TO SANITATION"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}
library(dplyr)
library(tidyr)
library(pollster)
library(ggplot2)
```

```{r}
colnames(MasterFile_NSS76th)

MasterFile_NSS76th_WASH=MasterFile_NSS76th %>% select(6,7,9,19,20,26:28,40,42:50,57,58,71,72,78,86,87,93:104,180,182,186,192)
```


latrine_type ==1~"Sewer",
latrine_type ==2~"Septic Tank",
latrine_type ==3~"Twin Pit",
latrine_type %in% c(4,6,7)~"Single Pit",
latrine_type ==8~"Open Pit",
latrine_type ==10~"Composting Pit",
latrine_type %in% c(11,19,5)~"Others",
latrine_type ==0~"No Latrine")
```{r}
#For type of latrine access - IHHL, Shared, PT/CT, No Latrines
#For India level data, create a dummy variable overall_dummy.

MasterFile_NSS76th_WASH=MasterFile_NSS76th_WASH %>%
  mutate(latrine_yn=if_else(latrine_access!=5,"Yes","No"))

sch5_1_level_4$latrine_type[sch5_1_level_4$latrine_yn=="No"]="No Latrine"


rbind(MasterFile_NSS76th %>%
  mutate(latrine_access_recodes=case_when(latrine_access==1~"IHHL",
                                          latrine_access %in% c(2,9)~"Shared",
                                          latrine_access %in% c(3,4)~"PT/CT",
                                          latrine_access==5~"No Latrine"),
         overall_dummy="India")%>%
  crosstab(x=overall_dummy,y=latrine_access_recodes,weight = multiplier)%>%rename("sector"="overall_dummy"),
MasterFile_NSS76th %>%
  mutate(latrine_access_recodes=case_when(latrine_access==1~"IHHL",
                                          latrine_access %in% c(2,9)~"Shared",
                                          latrine_access %in% c(3,4)~"PT/CT",
                                          latrine_access==5~"No Latrine"))%>%
  crosstab(x=sector,y=latrine_access_recodes,weight = multiplier))
```
```{r}
#Latrine type among those with a toilet
MasterFile_NSS76th %>%
  mutate(latrine_type_recoded = case_when(latrine_type==1~"Sewer",
                                           latrine_type==2~"Septic",
                                           latrine_type %in% c(3,4,5,6,7,8)~"Pit",
                                           latrine_type %in% c(10,19)~"Others",
                                           latrine_type==11~"Not Used"))%>%
  crosstab(x=sector,y=latrine_type_recoded,weight = multiplier/100)
```


```{r}
#crosstab type of latrines and access
MasterFile_NSS76th %>%
  mutate(latrine_access_recodes=case_when(latrine_access==1~"IHHL",
                                          latrine_access %in% c(2,9)~"Shared",
                                          latrine_access %in% c(3,4)~"PT/CT",
                                          latrine_access==5~"No Latrine"),
         latrine_type_recoded = case_when(latrine_type==1~"Sewer",
                                           latrine_type==2~"Septic",
                                           latrine_type %in% c(3,4,5,6,7,8)~"Pit",
                                           latrine_type %in% c(10,19)~"Others",
                                           latrine_type==11~"Not Used"))%>%
  crosstab_3way(x=sector,z=latrine_access_recodes,y=latrine_type_recoded,weight=multiplier)
```

```{r}
#Latrine Usage: IHHL, Shared, and OD
MasterFile_NSS76th %>%
  mutate(latrine_access_recodes=case_when(latrine_access==1 & latrine_type!=11~"IHHL",
                                          latrine_access %in% c(2,9,3,4) & latrine_type!=11~"Shared",
                                          latrine_type==11 | is.na(latrine_type)~"OD"))%>%
  crosstab(x=sector,y=latrine_access_recodes,weight = multiplier/100)
```

```{r}
MasterFile_NSS76th_WASH %>%
  mutate(dwsource_recoded=case_when(dwsource %in% c(2,3,4)~"Piped_Water",
                                    dwsource ==5~"Public_Standpost",
                                    dwsource ==6~"Tubewell",
                                    dwsource ==7~"Handpump",
                                    dwsource %in% c(8,9)~"Well",
                                    dwsource %in% c(10,11)~"Tanker",
                                    dwsource %in% c(12,13)~"Spring",
                                    dwsource ==14~"Rainwater",
                                    dwsource %in% c(15,16)~"Surface_Water",
                                    dwsource ==19~"Others",
                                    dwsource ==1~"Bottled Water"),
         dw_access_recoded=case_when(dw_access ==1~"Exclusive",
                                     dw_access %in% c(2,3)~"Shared",
                                     dw_access %in% c(4,5,6,7)~"Community",
                                     dw_access ==9~"Others",),
         dw_distance_recoded=case_when(dw_distance %in% c(1,2)~"Within_Dwelling_Premises",
                                       dw_distance %in% c(3,4,5,6,7)~"Outside_Dwelling_Premises"))%>%
  crosstab_3way(x=sector,y=dw_access_recoded,z=dwsource_recoded,weight = multiplier)

  
  
```

```{r}
#Individual latrine usage
level2_individualLevel %>%
  crosstab(x=Gender,y=use_of_latrine,weight = Multiplier)
```


```{r}
MasterFile_NSS76th %>%
  filter(sector==2)%>%
  mutate(latrine_access_recodes=case_when(latrine_access==1~"IHHL",
                                          latrine_access %in% c(2,9)~"Shared",
                                          latrine_access %in% c(3,4)~"PT/CT",
                                          latrine_access==5~"No Latrine"))%>%
  crosstab(x=area_type,y=latrine_access_recodes,weight = multiplier)
```

```{r}
MasterFile_NSS76th_WASH %>%
  filter(sector==2)%>%
  mutate(dwsource_recoded=case_when(dwsource %in% c(2,3,4)~"Piped_Water",
                                    dwsource ==5~"Public_Standpost",
                                    dwsource ==6~"Tubewell",
                                    dwsource ==7~"Handpump",
                                    dwsource %in% c(8,9)~"Well",
                                    dwsource %in% c(10,11)~"Tanker",
                                    dwsource %in% c(12,13)~"Spring",
                                    dwsource ==14~"Rainwater",
                                    dwsource %in% c(15,16)~"Surface_Water",
                                    dwsource ==19~"Others",
                                    dwsource ==1~"Bottled Water"),
         dw_access_recoded=case_when(dw_access ==1~"Exclusive",
                                     dw_access %in% c(2,3)~"Shared",
                                     dw_access %in% c(4,5,6,7)~"Community",
                                     dw_access ==9~"Others",),
         dw_distance_recoded=case_when(dw_distance %in% c(1,2)~"Within_Dwelling_Premises",
                                       dw_distance %in% c(3,4,5,6,7)~"Outside_Dwelling_Premises"))%>%
  crosstab(x=area_type,y=dwsource_recoded,weight = multiplier)
```

